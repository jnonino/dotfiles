name: Test Chezmoi repo

on:
  push:
    branches:
      - main

env:
  GH_USERNAME: jnonino

jobs:
  macos:
    runs-on: macOS-latest
    steps:
      - name: Install Chezmoi
        run: sudo sh -c "$(curl -fsLS get.chezmoi.io)" -- -b $HOME/bin
      - name: Configure dotfiles
        run: chezmoi init https://github.com/$GH_USERNAME/dotfiles.git

  unix-based:
    runs-on: ubuntu-latest
    steps:
      - name: Install Chezmoi
        run: sudo sh -c "$(curl -fsLS get.chezmoi.io)" -- -b /usr/bin
      - name: Configure dotfiles
        run: chezmoi init https://github.com/$GH_USERNAME/dotfiles.git

  windows-based:
    runs-on: windows-latest
    steps:
      - name: Install Chezmoi and configure dotfiles
        run: (irm -useb https://get.chezmoi.io/ps1) | powershell -c -
      - name: Configure dotfiles
        run: chezmoi init https://github.com/$GH_USERNAME/dotfiles.git
